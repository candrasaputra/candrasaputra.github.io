(this["webpackJsonpxendit-dashboard-ui"]=this["webpackJsonpxendit-dashboard-ui"]||[]).push([[96],{1544:function(e,t,a){"use strict";a.r(t);var n=a(24),c=a(3),s=a(9),o=a.n(s),r=a(19),i=a(12),l=a(0),d=a.n(l),u=a(1565),m=a(380),b=a(284),f=a(205),p=a(27),v=a(80),E=a(50),h=a(97),g=a(20),w=a.n(g),k=function(e){var t=e.t,a=e.isMobileView,n=e.navRef,c=e.isLoading,s=e.errorMessage,o=e.handleOpenZendesk,r=e.handleOpenActivateEscrowModal,i=e.environment,l=e.isEscrowActivated,m=e.vaList,b=e.vaListProd,f=e.isLive,p=e.canActivate,E=e.handleUpdateSelectedVa,g=e.handleActivateVa,k=function(e){return b[e].fva.isActive?"enabled":"disabled"},O=d.a.createElement("div",{className:"d-flex"},m.map((function(e,t){return d.a.createElement("div",{className:"payment-method-card-container",key:t},d.a.createElement(v.L,{methodIcon:"/images/".concat(e.bank_code.toLowerCase(),"-logo.svg"),methodName:e.bank_code,status:b&&k(t),environment:i,canActivate:p,isLive:f,onTestClicked:function(){return E(e,t,!0)},onRightButtonClicked:function(){return g(e,t)}}))}))),_=d.a.createElement(d.a.Fragment,null,d.a.createElement("p",{className:"mb-3"},t("p2pEscrowDesc")),d.a.createElement(w.a,{variant:"primary",onClick:r},t("activateEscrow")));return d.a.createElement("section",{id:"escrow",className:"mt-30",ref:n},d.a.createElement(v.z,{isLoading:c,loadingText:t("loadingEscrow"),isError:s,errorText:s,preserveMobile:!0,customBodyCss:a&&"p-3",customCss:"p-lg-3"},d.a.createElement("p",{className:"text-md font-weight-bold"},t("p2pEscrow")),l?O:_,d.a.createElement("p",{className:"mt-3"},d.a.createElement(u.a,{i18nKey:"settingsEscrowRdl:setCallbacks"},"To set your callback URLs,"," ",d.a.createElement(h.Link,{className:"font-weight-bold",to:"/settings/developers#callbacks"},"click here"))),d.a.createElement("p",null,d.a.createElement(u.a,{i18nKey:"settingsEscrowRdl:moreInfoEscrow"},"For more information on Instamoney P2P Escrow,"," ",d.a.createElement("span",{className:"text-primary clickable-text font-weight-bold",onClick:o},"chat with us")))))},O=function(e){var t=e.t,a=e.isMobileView,n=e.navRef,c=e.handleOpenZendesk;return d.a.createElement("section",{id:"rdl",className:"mt-30",ref:n},d.a.createElement(v.z,{loadingText:t("loadingEscrow"),preserveMobile:!0,customBodyCss:a&&"p-3",customCss:"p-lg-3"},d.a.createElement("p",{className:"text-md font-weight-bold"},t("rdl")),d.a.createElement("p",null,d.a.createElement(u.a,{i18nKey:"settingsEscrowRdl:moreInfoRdl"},"For more information on Instamoney RDL, please contact your account manager or"," ",d.a.createElement("span",{className:"text-primary clickable-text font-weight-bold",onClick:c},"chat with us"))),d.a.createElement("p",null,d.a.createElement(u.a,{i18nKey:"settingsEscrowRdl:setCallbacks"},"To set your callback URLs,"," ",d.a.createElement(h.Link,{className:"font-weight-bold",to:"/settings/developers#callbacks"},"click here")))))},_="/settings",y="/api/escrow_settings/development_mode_activations",j="/api/available_virtual_account_banks",M="/api/cva_settings",x="/api/callback_virtual_account_ranges",C=["BNI","MANDIRI"],N=a(28);a(2163),t.default=Object(m.a)(["settingsEscrowRdl","settingsMain","errorMessages","commonWords","settingsPaymentMethods"])((function(e){var t=e.history,a=e.apiCall,s=a.axiosPost,m=a.axiosGet,h=e.isMobileView,g=e.t,w=e.entity,L=e.environment,R=e.business,T=e.user,P=T.can_administer,A=T.can_manage_tech_settings,I=e.notify,V=w===N.a.INSTAMONEY&&R.permission.exclude_dashboard_page.includes("transactions"),S="LIVE"===R.go_live_status,U=P||A,D=Object(l.useState)(!1),B=Object(i.a)(D,2),W=B[0],F=B[1],K=Object(l.useState)(""),z=Object(i.a)(K,2),Z=z[0],J=z[1],Y=Object(l.useState)(!1),G=Object(i.a)(Y,2),X=G[0],$=G[1],q=Object(l.useState)(!1),H=Object(i.a)(q,2),Q=H[0],ee=H[1],te=Object(l.useState)([]),ae=Object(i.a)(te,2),ne=ae[0],ce=ae[1],se=Object(l.useState)([]),oe=Object(i.a)(se,2),re=oe[0],ie=oe[1],le=Object(l.useState)({}),de=Object(i.a)(le,2),ue=de[0],me=de[1],be=Object(l.useState)(null),fe=Object(i.a)(be,2),pe=fe[0],ve=fe[1],Ee=Object(l.useState)({BNI:"DEVELOPMENT"===L}),he=Object(i.a)(Ee,2),ge=he[0],we=he[1],ke=Object(l.useState)({title:"",subtitle:"",type:"",showModal:!1,handleConfirm:null}),Oe=Object(i.a)(ke,2),_e=Oe[0],ye=Oe[1],je="PRODUCTION"===L?ne:re,Me=Object(l.useRef)(),xe=Object(l.useRef)(),Ce=[{name:g("escrow"),section:"escrow",ref:Me},{name:g("rdl"),section:"rdl",ref:xe}];Object(l.useEffect)((function(){Le("PRODUCTION"),Le("DEVELOPMENT")}),[L]);var Ne=function(e,t,a,n){ye({title:e,subtitle:t,type:a,showModal:!0,handleConfirm:n})},Le=function(){var e=Object(r.a)(o.a.mark((function e(t){var a,n,c,s,r,l,d,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(""),F(!0),n=m(j,a={environment:t}),c=m(M,a),e.next=7,Promise.all([n,c]);case 7:if(s=e.sent,r=Object(i.a)(s,2),l=r[0],d=r[1],F(!1),!l.error_code&&!d.error_code){e.next=15;break}return J(g("errorMessages:unexpectedError")),e.abrupt("return");case 15:u=Re(l.available_va_banks,d.callback_virtual_account_banks),"PRODUCTION"===t?ce(u):ie(u);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(e,t){var a={};return e.forEach((function(e){var t=e.bank_code;C.includes(t)&&(a[t]={fva:{},bank_code:t})})),t.filter((function(e){return C.includes(e.bank_code)})).forEach((function(e){var t=e.bank_code,n=e.account_block_start,s=e.account_block_end,o=!Object(p.isUndefined)(n)||!Object(p.isUndefined)(s);a[t].fva=Object(c.a)(Object(c.a)({},e),{},{isActive:o})})),Object.keys(a).map((function(e){return a[e]}))},Te=function(){window.$zopim.livechat.window.show(),window.zE("webWidget:on","close",(function(){window.zE("webWidget","hide")}))},Pe=function(){var e=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!0),e.next=3,s(y);case 3:if(t=e.sent,ee(!1),$(!1),!t.error_code){e.next=9;break}return Ne(g("commonWords:error"),Object(E.f)(t.error_code,g),"danger"),e.abrupt("return");case 9:Ne(g("commonWords:success"),g("successActivate"),"success",(function(){return window.location.reload()}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(e,t){var a=Object(n.a)(ne);a[ne.findIndex((function(t){return t.bank_code===e.toUpperCase()}))].isEnabling=t,ce(a)},Ie=function(e,t,a){me(e),ve(t);var n=Object(c.a)({},ge);n[e.bank_code]=a,we(n)},Ve=function(){var e=Object(r.a)(o.a.mark((function e(t){var a,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.bank_code,n=t.fva,c=a,!n.isActive&&U){e.next=4;break}return e.abrupt("return");case 4:if(Ae(a,!0),n.isActive){e.next=10;break}return e.next=8,s(x,{bank_code:a.toUpperCase()});case 8:e.sent.error_code&&I({type:"error",message:g("settingsPaymentMethods:errorActivatingFVARange",{methodName:c})});case 10:Le("PRODUCTION"),Le("DEVELOPMENT"),Ae(a,!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(e){return e.map((function(e){var t=e.fva,a=e.bank_code,n=e.isEnabling,c=a,s=t.isActive?"".concat(t.merchant_code," ").concat(t.account_block_start," - ").concat(t.merchant_code," ").concat(t.account_block_end):"-",o=[{name:g("settingsPaymentMethods:fvaRange"),value:n?d.a.createElement(v.X,null):s},{name:g("settingsPaymentMethods:settledTo"),value:g("settingsPaymentMethods:dashboardBalance")},{name:g("settingsPaymentMethods:settlementTime"),value:g("settingsPaymentMethods:instant")}];return{title:g("settingsPaymentMethods:vaDetailsTitle",{vaName:c}),icon:"/images/".concat(a.toLowerCase(),"-logo.svg"),details:o,link:{text:d.a.createElement(u.a,{i18nKey:"learnMoreVa",t:g},"Learn more about",d.a.createElement("a",{href:"https://docs.instamoney.co/dashboard-docs/fixed-virtual-accounts.html",target:"_blank",rel:"noopener noreferrer"},g("settingsPaymentMethods:fva")))}}}))};return d.a.createElement(d.a.Fragment,null,d.a.createElement(v.o,{title:g(h?"settingsMain:p2pEscrowRdl":"settingsMain:backToSettings"),goBack:function(){return t.push(_)},bottomStickContent:h&&d.a.createElement(v.U,{items:Ce,isLoading:W})}),d.a.createElement(b.a,null,!h&&d.a.createElement(f.a,{lg:2,className:"px-0"},d.a.createElement(v.U,{items:Ce,isLoading:W})),d.a.createElement(f.a,{lg:10,className:h&&"pt-3 p-0"},d.a.createElement("div",{className:!h&&"container"},d.a.createElement(k,{isLoading:W,errorMessage:Z,t:g,isMobileVie:h,navRef:Me,handleOpenZendesk:Te,handleOpenActivateEscrowModal:function(){return $(!0)},environment:L,vaList:je,vaListProd:ne,isEscrowActivated:V,isLive:S,canActivate:U,selectedVa:ue,selectedVaIndex:pe,setSelectedVa:me,setSelectedVaIndex:ve,isTestMode:ge,setIsTestMode:we,handleUpdateSelectedVa:Ie,handleActivateVa:function(e,t){Ie(e,t,!1),Ve(ne[t])}}),d.a.createElement(O,{t:g,isMobileView:h,navRef:xe,handleOpenZendesk:Te})))),d.a.createElement(v.j,{entity:w,type:"info",title:g("commonWords:wait"),subtitle:d.a.createElement(d.a.Fragment,null,d.a.createElement("p",null,g("onceYouActivateEscrow")),d.a.createElement("p",null,g("youMustEscrow")),d.a.createElement("p",null,d.a.createElement(u.a,{i18nKey:"settingsEscrowRdl:seeEscrowApi"},"See our Escrow APIs"," ",d.a.createElement("a",{href:"https://docs.instamoney.co/p2p-escrow-apireference",target:"_blank",rel:"noopener noreferrer"},"here")))),showModal:X,withCancel:!0,cancelButtonText:g("commonWords:no"),buttonText:g("commonWords:activate"),handleConfirm:Pe,handleCancel:function(){return $(!1)},isButtonLoading:Q}),d.a.createElement(v.j,Object.assign({},_e,{handleClose:function(){ye({title:"",subtitle:"",type:"",showModal:!1,handleConfirm:null})}})),d.a.createElement(v.M,{showModal:!Object(p.isEmpty)(ue),handleClose:function(){if((ge[ue.bank_code]?"DEVELOPMENT":"PRODUCTION")!==L){var e=Object(c.a)({},ge);e[ue.bank_code]=!e[ue.bank_code],we(e)}me({})},t:g,isTestView:ge[ue.bank_code],environment:L,isLive:S,showSwitcher:S,paymentMethodDetails:ge[ue.bank_code]?Se(re)[pe]:Se(ne)[pe],onToggleClick:function(){ge[ue.bank_code]&&Ve(ne[pe]);var e=Object(c.a)({},ge);e[ue.bank_code]=!e[ue.bank_code],we(e)},customCss:"p2p-escrow-modal",entity:w,openChat:Te}))}))},2163:function(e,t,a){}}]);