(this["webpackJsonpxendit-dashboard-ui"]=this["webpackJsonpxendit-dashboard-ui"]||[]).push([[85],{1543:function(t,e,a){"use strict";a.r(e);var n=a(24),r=a(9),c=a.n(r),o=a(3),s=a(19),i=a(12),u=a(0),l=a.n(u),d=a(380),f=a(67),m=a(27),b=a(1598),p=a.n(b),O=a(108),j=a.n(O),h=a(37),E=a(26),y=a(1583),x=a.n(y),g=a(20),v=a.n(g),S=a(48),T=a(31),C=a.n(T),w=a(80),_=a(1575),D=a.n(_),L=a(1573),A=a(231),k=["COMPLETED","DETECTED"],F=["ALFAMART","INDOMARET"],M="/api/fixed-payment-code-deposits/",I="/api/fixed-payment-code-deposits-statistics/",N="/api/fixed-payment-code-deposits-report-requests/",R=function(t,e){return{xendit:[{title:t("channel"),children:[{type:"ALFAMART",label:"Alfamart"},{type:"INDOMARET",label:"Indomaret"}]},{title:t("status"),children:[{type:"COMPLETED",label:t("settled")},{type:"DETECTED",label:t("paid")}]}],instamoney:[{children:[{type:"COMPLETED",label:t("settled")},{type:"DETECTED",label:t("paid")}]}]}[e]},P=a(28),q=a(288),B=a.n(q),G={COMPLETED:"SETTLED",DETECTED:"PAID"},J=function(t){switch(t){case"COMPLETED":case"DETECTED":return l.a.createElement(D.a,{variant:"success",text:B()(G[t].toLowerCase())});default:return l.a.createElement(D.a,{text:B()(t.toLowerCase())})}},U=function(t){return l.a.createElement(A.a,{height:20,src:"/images/".concat(t.toLowerCase(),"-logo.svg")})},z=function(t,e){var a=[{dataField:"status",formatter:J,headerStyle:{width:"13%"},text:t("status")},{dataField:"retail_outlet_name",formatter:U,headerStyle:{width:"10%"},text:t("channel")},{dataField:"payment_code",type:"text",headerStyle:{width:"15%"},text:t("paymentCode")},{dataField:"name",type:"text",headerStyle:{width:"15%"},text:t("name")},{dataField:"amount",formatter:function(t){return Object(L.b)(t,"IDR")},headerStyle:{width:"15%"},text:t("amount")},{dataField:"external_id",type:"text",headerStyle:{width:"12%"},text:t("reference")},{dataField:"created",formatter:function(t){return C()(t).format(S.a.TABLE_DT_FORMAT)},headerStyle:{width:"20%"},text:t("paymentDate")}];return e===P.a.INSTAMONEY&&a.splice(1,1),a},H=a(284),Y=a(205),Z="/images/icons/completed.svg",Q="/images/icons/transactions.svg",V=Object(d.a)("retailOutlets")((function(t){var e=t.totalPaidAmount,a=t.totalTransactionsCount,n=t.t,r=t.isLoading,c=[{text:n("totalPaid"),icon:Z,amount:e&&Object(L.d)(e),currency:"IDR"},{text:n("totalTransactions"),icon:Q,amount:a}];return l.a.createElement(H.a,{className:"retail-outlets-stats"},c.map((function(t,e){return l.a.createElement(Y.a,{key:e,md:6},l.a.createElement(w.Z,{key:e,text:t.text,icon:t.icon,amount:t.amount,currency:t.currency,isLoading:r}))})))})),$=a(468),K=a(189),W=S.c.TODAY,X=S.c.LAST_1_MONTH,tt=S.c.TIMEZONE;e.default=Object(f.o)(Object(d.a)(["retailOutlets","errorMessages","commonComponents"])((function(t){var e=t.t,a=t.history,r=t.apiCall,d=r.axiosGet,f=r.axiosPost,b=t.environment,O=t.user.email,y=t.business,g=t.dateFormat,T=t.entity,_=Object(u.useState)([]),D=Object(i.a)(_,2),q=D[0],B=D[1],G=Object(u.useState)({paid:0,transactions:0}),U=Object(i.a)(G,2),H=U[0],Y=U[1],Z=Object(u.useState)(""),Q=Object(i.a)(Z,2),et=Q[0],at=Q[1],nt=Object(u.useState)(""),rt=Object(i.a)(nt,2),ct=rt[0],ot=rt[1],st=Object(u.useState)(k),it=Object(i.a)(st,2),ut=it[0],lt=it[1],dt=Object(u.useState)(F),ft=Object(i.a)(dt,2),mt=ft[0],bt=ft[1],pt=Object(u.useState)(new Date(X)),Ot=Object(i.a)(pt,2),jt=Ot[0],ht=Ot[1],Et=Object(u.useState)(new Date(W)),yt=Object(i.a)(Et,2),xt=yt[0],gt=yt[1],vt=Object(u.useState)({transactions:!1,stats:!1,refetch:!1}),St=Object(i.a)(vt,2),Tt=St[0],Ct=St[1],wt=Object(u.useState)(""),_t=Object(i.a)(wt,2),Dt=_t[0],Lt=_t[1],At=Object(u.useState)(!1),kt=Object(i.a)(At,2),Ft=kt[0],Mt=kt[1],It=Object(u.useState)(!1),Nt=Object(i.a)(It,2),Rt=Nt[0],Pt=Nt[1],qt=Object(u.useState)(null),Bt=Object(i.a)(qt,2),Gt=Bt[0],Jt=Bt[1],Ut=Object(u.useState)(!1),zt=Object(i.a)(Ut,2),Ht=zt[0],Yt=zt[1],Zt=Object(u.useState)(null),Qt=Object(i.a)(Zt,2),Vt=Qt[0],$t=Qt[1],Kt=Object(u.useState)(!1),Wt=Object(i.a)(Kt,2),Xt=Wt[0],te=Wt[1],ee=Object(u.useState)(!1),ae=Object(i.a)(ee,2),ne=ae[0],re=ae[1],ce=Object(u.useState)(""),oe=Object(i.a)(ce,2),se=oe[0],ie=oe[1],ue=function(){var t=Object(s.a)(c.a.mark((function t(){var e,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{transactions:!0})})),t.next=3,p.a.getItem("LAST_RO_TRANSACTIONS");case 3:if(e=t.sent,!(a.location.state&&a.location.state.isFromDetailsPage)||Object(m.isNull)(e)){t.next=22;break}return n=JSON.parse(e),B(n.roData),at(n.lastId),Mt(n.hasNext),ht(new Date(n.dateStart)),gt(new Date(n.dateEnd)),ot(n.searchQuery),lt(n.statuses),bt(n.channels),Y(n.roStats),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{transactions:!1})})),t.next=19,p.a.removeItem("LAST_RO_TRANSACTIONS");case 19:a.replace({pathname:a.location.pathname,state:{}}),t.next=24;break;case 22:de(),fe();case 24:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(u.useEffect)((function(){ue()}),[b]),Object(u.useEffect)((function(){clearTimeout(Vt),$t(setTimeout((function(){if(Object(m.isEmpty)(mt)&&Object(m.isEmpty)(ut))return B([]),void Y({paid:0,transactions:0});Ht&&(de(),fe(),Yt(!1))}),500))}),[ut,mt,jt,xt]),Object(u.useEffect)((function(){Object(m.isEmpty)(mt)||Object(m.isEmpty)(ut)||(clearTimeout(Gt),Jt(setTimeout((function(){Ht&&!Object(m.isUndefined)(ct)&&(ct.length>2||0===ct.length)&&(de(),fe(),Yt(!1))}),500)))}),[ct]);var le,de=function(){var t=Object(s.a)(c.a.mark((function t(){var a,r,s,i,u,l,f=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f.length>0&&void 0!==f[0]&&f[0],r={from:Object(K.c)(jt,"start"),to:Object(K.c)(xt,"end"),statuses:Object(m.isEmpty)(ut)?k:ut,last_id:a?et:void 0,retail_outlet_name:mt.length===F.length||Object(m.isEmpty)(mt)?void 0:mt.toString()},ct&&(r.search_query=ct.trim(),delete r.from,delete r.to),Lt(""),!a&&Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{transactions:!0})})),t.prev=5,t.next=8,d(M,r);case 8:if(!(s=t.sent).error_code){t.next=11;break}throw s;case 11:t.next=18;break;case 13:return t.prev=13,t.t0=t.catch(5),Lt(Object($.a)(t.t0.error_code,e)),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{transactions:!1})})),t.abrupt("return");case 18:i=s.has_next,u=i?Object(m.last)(s.docs).id:"",l=a?[].concat(Object(n.a)(q),Object(n.a)(s.docs)):s.docs,at(u),Mt(i),B(l),a&&Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{refetch:!1})})),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{transactions:!1})}));case 26:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(){return t.apply(this,arguments)}}(),fe=function(){var t=Object(s.a)(c.a.mark((function t(){var a,n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={from:Object(K.c)(jt,"start"),to:Object(K.c)(xt,"end"),statuses:Object(m.isEmpty)(ut)?k:ut,retail_outlet_name:mt.length===F.length||Object(m.isEmpty)(mt)?void 0:mt.toString()},ct&&(a.search_query=ct.trim(),delete a.from,delete a.to),Lt(""),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{stats:!0})})),t.prev=4,t.next=7,d(I,a);case 7:if(!(n=t.sent).error_code){t.next=10;break}throw n;case 10:t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(4),Lt(Object($.a)(t.t0.error_code,e)),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{stats:!1})})),t.abrupt("return");case 17:r={paid:n.total_completed_amount+n.total_detected_amount,transactions:n.total_count},Y(r),Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{stats:!1})}));case 20:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(){return t.apply(this,arguments)}}(),me=function(t,e){var a=Object(n.a)(t);return t.includes(e)?a=a.filter((function(t){return t!==e})):a.push(e),a},be=function(){var t=Object(s.a)(c.a.mark((function t(){var a,n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return te(!0),ie(""),re(!1),a=j()().utcOffset(),n={statuses:ut||k,from:Object(K.c)(jt,"start"),to:Object(K.c)(xt,"end"),user_offset:a},ct&&(n.search_query=ct.trim()),window.dataLayer=window.dataLayer||[],window.dataLayer.push({businessId:y.id,event:"export-ro-report",label:"Export CSV - Retail Outlet"}),t.next=10,f(N,n);case 10:if(r=t.sent,te(!1),!r.error_code){t.next=15;break}return ie(Object($.a)(r.error_code,e)),t.abrupt("return");case 15:re(!0),Pt(!0);case 17:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),pe={value:ct,onChange:function(t){t.preventDefault(),ot(t.target.value),Yt(!0)},tooltip:e("searchTooltip"),placeholder:e("searchPlaceholder"),position:"inline",customCss:"filter-item"},Oe={start:jt,end:xt,inputFormat:g.date_time_picker,outputFormat:S.a.GMT_MS_Z,onChange:function(t,e){switch(t){case"start":ht(new Date(j()(e).tz(tt).format()));break;case"end":gt(new Date(j()(e).tz(tt).format()))}Yt(!0)},customCss:"filter-item"},je={isClickable:!0,tableHeaderColumns:z(e,T),tableContentRows:q,mobileTableContent:(le=q,le.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{status:J(t.status),dateContent:{date:C()(t.created).format(S.a.FULL_DATE)},additionalData:Object(L.b)(t.amount,"IDR"),secondRowContent:l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement("p",{className:"mb-0 mr-6 text-sm color-charcoal font-weight-bold"},"".concat(t.external_id)),l.a.createElement(A.a,{src:"/images/".concat(t.retail_outlet_name.toLowerCase(),"-logo.svg"),width:"40",height:"12.51"}))})}))),onClickLoadMore:function(){Ct((function(t){return Object(o.a)(Object(o.a)({},t),{},{refetch:!0})})),de(!0)},withLoadMore:Ft,loadMoreText:e("commonComponents:tableMore"),isLoadingMore:Tt.refetch,isLoading:Tt.transactions,isError:!Object(m.isEmpty)(Dt),isEmpty:Object(m.isEmpty)(q),loadingText:e("loadingROData"),errorContent:l.a.createElement(w.t,{text:Dt}),emptyContent:l.a.createElement(w.r,{caption:e("emptyROData"),subtitle:e("tryAdjustFilter")}),onDetailsClicked:function(t){p.a.setItem("LAST_RO_TRANSACTIONS",JSON.stringify({lastId:et,hasNext:Ft,roData:q,roStats:H,channels:mt,dateStart:jt,dateEnd:xt,searchQuery:ct,statuses:ut})),a.replace({pathname:a.location.pathname,state:{isFromDetailsPage:!0}}),a.push("/retail_outlets/".concat(t.id))},rowClasses:"table-row-vertical-align-middle table-clickable-row"},he=function(t){var e=t.statuses,a=t.channels,r=t.onSelectFilter,c=t.t,o=t.onCheckAll,s=t.entity,i={xendit:{filterItems:[].concat(Object(n.a)(e),Object(n.a)(a)),displayText:"filter"},instamoney:{filterItems:Object(n.a)(e),displayText:"status"}},u=i[s].filterItems.length,d=l.a.createElement(w.w,{selectedFilters:i[s].filterItems,onChecked:r,filterGroups:R(c,s),withGrouping:!0,withCheckAll:!0,onCheckAll:o});return[l.a.createElement(w.q,{displayText:"".concat(c(i[s].displayText)," (").concat(u,")"),children:[d]})]}({statuses:ut,channels:mt,onSelectFilter:function(t){if(F.includes(t)){var e=me(mt,t);bt(e)}else{var a=me(ut,t);lt(a)}Yt(!0)},t:e,onCheckAll:function(){var t=[].concat(Object(n.a)(mt),Object(n.a)(ut)),e=Object(m.isEmpty)(t)?F:[],a=Object(m.isEmpty)(t)?k:[];bt(e),lt(a),Yt(!0)},entity:T}),Ee=T===P.a.INSTAMONEY?[l.a.createElement(v.a,{iconLeft:l.a.createElement(h.a,{icon:E.p}),onClick:be,isLoading:Xt,size:"sm"},"CSV")]:[];return l.a.createElement(l.a.Fragment,null,l.a.createElement(V,{totalPaidAmount:H.paid,totalTransactionsCount:H.transactions,isLoading:Tt.stats}),l.a.createElement(x.a,{filters:he,stickyHeader:!0,searchBarConfig:pe,dateFilterConfig:Oe,tableConfig:je,rightButtons:Ee}),function(t){return t?l.a.createElement(w.j,{type:"success",handleClose:function(){Pt(!1)},title:e("commonComponents:exportStarted"),subtitle:e("commonComponents:exportSuccessInfo",{email:O}),showModal:Rt}):l.a.createElement(w.j,{type:"danger",title:e("exportFailed"),handleClose:function(){Pt(!1)},showModal:Rt,subtitle:se})}(ne))})))},1573:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"d",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"e",(function(){return i}));var n=function(t,e){return"IDR"!==e&&e?t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"):t.toFixed(2).replace(".",",").replace(/\B(?=(\d{3})+(?!\d))/g,".")},r=function(t){return t.toLocaleString("en-US").replace(/,/g,".")},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.toLocaleString("en-US",{minimumFractionDigits:e?2:0})},o=function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=c(t,n),o="IDR"===e?r.replace(/,/g,"."):r,s=a?"".concat(e," "):"",i="".concat(s).concat(o);return i},s=function(t,e,a){var n=e?o(t,e):c(t),r=n.split("-").join(""),s="".concat((null!=a?a:t>0)?"+ ":"- "," ").concat(r);return 0===t&&(s=n),s},i=function(t){return"".concat((100*t).toFixed(2),"%")}},1575:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(0)),r=s(a(2)),c=s(a(6)),o=s(a(1576));function s(t){return t&&t.__esModule?t:{default:t}}function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a(1577);var u=function(t){var e,a=t.text,r=t.iconLeft,s=t.customCss,u=t.variant,l=(0,c.default)((i(e={"status-pill":!0},"status-pill-".concat(u),u),i(e,s,s),e));return n.default.createElement(o.default,{text:a,iconLeft:r,customCss:l})};u.propTypes={text:r.default.string,iconLeft:r.default.any,variant:r.default.oneOf(["success","danger","warning","first-level","second-level"]),customCss:r.default.string};var l=u;e.default=l},1576:function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),t.exports=a(467)},1577:function(t,e,a){}}]);