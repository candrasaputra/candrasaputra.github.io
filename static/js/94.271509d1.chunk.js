(this["webpackJsonpxendit-dashboard-ui"]=this["webpackJsonpxendit-dashboard-ui"]||[]).push([[94],{1514:function(e,t,a){"use strict";a.r(t);var i=a(3),n=a(24),l=a(9),s=a.n(l),c=a(19),o=a(12),r=a(0),p=a.n(r),u=a(380),d=a(27),m=a(468),I=a(167),f=a(189),b=a(150),j={ipAddress:"",isValidIp:!1,isIpDuplicateInBlockList:!0,isIpDuplicateInAllowList:!0,isIpDuplicateInBlockListMessage:"",isIpDuplicateInAllowListMessage:""},g={fromIp:{fromIpAddress:"",isValidFromIp:!1,isFromIpDuplicateInBlockList:!0,isFromIpDuplicateInAllowList:!0,isFromIpDuplicateInBlockListMessage:"",isFromIpDuplicateInAllowListMessage:""},toIp:{toIpAddress:"",isValidToIp:!1,isToIpDuplicateInBlockList:!0,isToIpDuplicateInAllowList:!0,isToIpDuplicateInBlockListMessage:"",isToIpDuplicateInAllowListMessage:""},isToIpGreaterThanFromIp:!1,isRangeIpDuplicate:!0,isRangeIpDuplicateMessage:""},O=function(e){var t=e;return e.includes("-")&&(t=e.split("-").join(" - ")),t},D=function(e){var t=e.split(".").map((function(e){return("000"+e).substr(-3)})).join("");return parseInt(t)},L=function(e,t){var a,i=D(e);if(0===t.length)a=!1;else for(var n=0;n<t.length;n++)if(t[n].ip.includes("-")){var l=t[n].ip.split("-"),s=D(l[0]),c=D(l[1]);if(i<s||i>c)a=!1;else if(a=!0,i>s&&i<c||(i===s||i===c))break}else{if(t[n].ip===e){a=!0;break}a=!1}return a},E=a(80),v=a(1565),w=Object(u.a)("fraudGuard")((function(e){var t,a=e.isAllowList,i=e.listEventHistory,n=e.isLoading,l=e.t,s=i.email,c=i.timestamp,o=""===s&&""===c,r=l(a?"ipAllowList":"ipBlockList"),u=p.a.createElement("p",{className:"text-md font-weight-bold mb-0"},r);if(n)t=l("fetchingEventHistory");else{var d=p.a.createElement(v.a,{i18nKey:"fraudListEventHistory"},"This list was last modified by"," ",p.a.createElement("span",{className:"font-weight-bold"},{email:s})," on"," ",p.a.createElement("span",{className:"font-weight-bold"},{timestamp:c}),".");t=o?l("fraudListEventHistoryEmpty"):d}var m=l(a?"ipAllowListDescription":"ipBlockListDescription"),I=l(a?"ipAllowListExample":"ipBlockListExample"),f=p.a.createElement(p.a.Fragment,null,p.a.createElement("p",{className:"color-charcoal"},t),p.a.createElement("p",{className:"mt-2 mb-0"},m),p.a.createElement("p",null,I));return p.a.createElement(E.z,{title:u,children:f})})),h=a(37),A=a(26),k=a(20),M=a.n(k),x=a(290),B=a.n(x),T=(a(1934),Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.list,a=e.isLoading,i=e.errorMessage,n=e.openAddModal,l=e.openDeleteModal,s=e.allowedToEdit,c=e.t,o=[{dataField:"ipValue",text:c("ip"),headerStyle:{width:"20%"}},{dataField:"formattedDate",text:c("dateAdded"),headerStyle:{width:"20%"}},{dataField:"deleteButton",text:"",headerStyle:{width:"60%"}}],r=t.map((function(e){var t=e.ip,a=e.updated;return{ipValue:O(t),formattedDate:Object(f.h)(a),deleteButton:s?p.a.createElement(E.h,{withTooltip:!1,icon:p.a.createElement(h.a,{icon:A.K}),onClick:function(){return l(t)},customCss:"btn-no-bg table-icon-button"}):null}})),u=p.a.createElement(M.a,{iconLeft:p.a.createElement(h.a,{icon:A.C}),size:"sm",onClick:n},c("commonWords:add")),m=s&&p.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},p.a.createElement("p",{className:"color-charcoal"},c("addListInstruction")),u);return p.a.createElement(E.z,{isLoading:a,loadingText:c("loadingYourList"),isError:!Object(d.isEmpty)(i),errorText:i,isEmpty:Object(d.isEmpty)(t),emptySubtitle:c("emptyFraudListCaption"),title:m},p.a.createElement(B.a,{noBorder:!0,tableHeaderColumns:o,tableContentRows:r,customCssRow:"fraud-list-table-row"}))}))),F=a(49),y=a.n(F),_=a(149),N=a.n(_),V=Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.specificIpInput,a=e.rangeIpInput,i=e.isAllowList,n=e.isModalOpen,l=e.closeAddModal,s=e.setActiveTab,c=e.activeTab,o=e.handleChange,r=e.addData,u=e.isAddingData,d=e.t,m=t.ipAddress,I=t.isValidIp,f=t.isIpDuplicateInBlockList,b=t.isIpDuplicateInAllowList,j=t.isIpDuplicateInBlockListMessage,g=t.isIpDuplicateInAllowListMessage,O=a.fromIp,D=O.fromIpAddress,L=O.isValidFromIp,v=O.isFromIpDuplicateInBlockList,w=O.isFromIpDuplicateInAllowList,k=O.isFromIpDuplicateInBlockListMessage,x=O.isFromIpDuplicateInAllowListMessage,B=a.toIp,T=B.toIpAddress,F=B.isValidToIp,_=B.isToIpDuplicateInBlockList,V=B.isToIpDuplicateInAllowList,C=B.isToIpDuplicateInBlockListMessage,S=B.isToIpDuplicateInAllowListMessage,G=a.isToIpGreaterThanFromIp,R=a.isRangeIpDuplicate,H=a.isRangeIpDuplicateMessage,W=[d("specific"),d("range")],z=p.a.createElement("ul",{className:"d-flex justify-content-between align-items-center ip-tab-switcher p-0 mb-5"},W.map((function(e,t){var a=c===t?"active":"";return p.a.createElement("li",{key:t,className:"text-center ip-tab-switcher-item ".concat(a),onClick:function(){return s(t)}},e)}))),J=d(i?"addIpAllow":"addIpBlock"),K=!f&&!b,P=I?"valid":"",Y=K?"valid":"",q=I&&K,Q=!v&&!w&&!R,U=L?"valid":"",X=Q?"valid":"",Z=G?"valid":"",$=!_&&!V&&!R,ee=F?"valid":"",te=$?"valid":"",ae=L&&F&&G&&Q&&$,ie=p.a.createElement(p.a.Fragment,null,p.a.createElement("p",{className:"d-flex align-items-center input-validity mt-2 mb-2 ".concat(P)},p.a.createElement(h.a,{icon:A.h}),d("validIpFormat")),p.a.createElement("p",{className:"d-flex align-items-center input-validity mb-2 ".concat(Y)},p.a.createElement(h.a,{icon:A.h}),d("notDuplicated")),p.a.createElement("p",{className:"color-danger"},j,g)),ne=p.a.createElement(p.a.Fragment,null,p.a.createElement("p",{className:"d-flex align-items-center input-validity mt-2 mb-2 ".concat(U)},p.a.createElement(h.a,{icon:A.h}),d("validIpFormat")),p.a.createElement("p",{className:"d-flex align-items-center input-validity mb-2 ".concat(X)},p.a.createElement(h.a,{icon:A.h}),d("notDuplicated")),p.a.createElement("p",{className:"color-danger"},k,x,p.a.createElement("br",null),H)),le=p.a.createElement(p.a.Fragment,null,p.a.createElement("p",{className:"d-flex align-items-center input-validity mt-2 mb-2 ".concat(ee)},p.a.createElement(h.a,{icon:A.h}),d("validIpFormat")),p.a.createElement("p",{className:"d-flex align-items-center input-validity mb-2 ".concat(Z)},p.a.createElement(h.a,{icon:A.h}),d("greaterThanFromIp")),p.a.createElement("p",{className:"d-flex align-items-center input-validity mb-2 ".concat(te)},p.a.createElement(h.a,{icon:A.h}),d("notDuplicated")),p.a.createElement("p",{className:"color-danger"},C,S,p.a.createElement("br",null),H)),se=p.a.createElement("div",{className:"d-flex flex-column mb-4"},p.a.createElement(N.a,{name:"specificIp",placeholder:"e.g. 192.168.0.14",value:m,useDefaultValue:!0,defaultValue:m}),ie),ce=p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"d-flex flex-column mb-3"},p.a.createElement(N.a,{name:"fromIp",placeholder:"e.g. 192.168.0.14",value:D,useDefaultValue:!0,defaultValue:D,label:d("from")}),ne),p.a.createElement("div",{className:"d-flex flex-column"},p.a.createElement(N.a,{name:"toIp",placeholder:"e.g. 192.168.0.20",value:T,useDefaultValue:!0,defaultValue:T,label:d("to")}),le)),oe=p.a.createElement(E.gb,{onChange:o,onSubmit:function(e){return r(e)}},0===c&&se,1===c&&ce),re=p.a.createElement("div",{className:"text-left mt-3"},z,oe),pe=p.a.createElement(M.a,{size:"md",type:"submit",isDisabled:0===c?!q:!ae,isLoading:u,onClick:r},d("commonWords:add"));return p.a.createElement(y.a,{showModal:n,handleClose:l,title:J,children:re,footer:pe,size:"sm"})})),C=Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.toBeDeletedIp,a=e.isAllowList,i=e.isModalOpen,n=e.closeDeleteModal,l=e.deleteData,s=e.isDeletingData,c=e.t,o=c(a?"deleteIpAllow":"deleteIpBlock"),r=O(t),u=c(a?"deleteIpAllowInstruction":"deleteIpBlockInstruction"),d=p.a.createElement("div",{className:"confirmation-modal-additional-content text-left mt-3"},p.a.createElement("div",{className:"d-flex text-left mb-4"},p.a.createElement("span",{className:"color-charcoal mr-2"},c("ipAddress"),": "),p.a.createElement("span",{className:"font-weight-bolder"},r)),p.a.createElement("p",{className:"text-left color-charcoal mb-0"},u));return p.a.createElement(E.j,{type:"danger",title:o,showModal:i,handleClose:n,handleConfirm:l,withCancel:!0,isButtonLoading:s,buttonText:c("commonWords:delete"),buttonType:"destructive",buttonCustomCss:"min-width-120",additionalContent:d})}));t.default=Object(u.a)(["fraudGuard","creditCardErrorMessages","errorMessages"])((function(e){var t=e.location,a=e.history,l=e.apiCall,u=e.user,O=e.environment,v=e.t,h=t.pathname.split("/"),A="ip_allow_list"===h[h.length-1],k=u.can_administer,M=u.can_manage_tech_settings,x=k&&M,B=Object(r.useState)(!1),F=Object(o.a)(B,2),y=F[0],_=F[1],N=Object(r.useState)({email:"",timestamp:""}),S=Object(o.a)(N,2),G=S[0],R=S[1],H=Object(r.useState)(!1),W=Object(o.a)(H,2),z=W[0],J=W[1],K=Object(r.useState)({blockList:[],allowList:[]}),P=Object(o.a)(K,2),Y=P[0],q=P[1],Q=Object(r.useState)({from:[],to:[]}),U=Object(o.a)(Q,2),X=U[0],Z=U[1],$=Object(r.useState)(!1),ee=Object(o.a)($,2),te=ee[0],ae=ee[1],ie=Object(r.useState)(""),ne=Object(o.a)(ie,2),le=ne[0],se=ne[1],ce=Object(r.useState)(0),oe=Object(o.a)(ce,2),re=oe[0],pe=oe[1],ue=Object(r.useState)(!1),de=Object(o.a)(ue,2),me=de[0],Ie=de[1],fe=Object(r.useState)(!1),be=Object(o.a)(fe,2),je=be[0],ge=be[1],Oe=Object(r.useState)(j),De=Object(o.a)(Oe,2),Le=De[0],Ee=De[1],ve=Object(r.useState)(g),we=Object(o.a)(ve,2),he=we[0],Ae=we[1],ke=Object(r.useState)(""),Me=Object(o.a)(ke,2),xe=Me[0],Be=Me[1],Te=Object(r.useState)(!1),Fe=Object(o.a)(Te,2),ye=Fe[0],_e=Fe[1],Ne=Object(r.useState)({title:"",description:""}),Ve=Object(o.a)(Ne,2),Ce=Ve[0],Se=Ve[1],Ge=Object(r.useState)(""),Re=Object(o.a)(Ge,2),He=Re[0],We=Re[1];Object(r.useEffect)((function(){_(!0),ze(),Ke()}),[]),Object(r.useEffect)((function(){Ye()}),[Y]),Object(r.useEffect)((function(){$e(),et(),tt(),at(),it()}),[me,ye]),Object(r.useEffect)((function(){Se({title:"",description:""})}),[me,je]),Object(r.useEffect)((function(){Xe()}),[he.fromIp.fromIpAddress,he.toIp.toIpAddress]),Object(r.useEffect)((function(){y&&st()}),[O]);var ze=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),e.prev=1,e.next=4,l.axiosGet(I.d.ccSettingsLogger);case 4:return t=e.sent,e.next=7,Je(t);case 7:if(!t.error_code){e.next=9;break}throw t;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),se(Object(m.b)(e.t0.error_code,v));case 14:J(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),Je=function(e){var t=e.ip_blocked_list,a=e.ip_allowed_list,i=A?a:t;R({email:Object(d.isEmpty)(i)?"":i.last_update_history_item.email,timestamp:Object(d.isEmpty)(i)?"":Object(f.h)(i.last_update_history_item.timestamp)})},Ke=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae(!0),e.prev=1,e.next=4,l.axiosGet(I.d.customFraudRules);case 4:return t=e.sent,e.next=7,Pe(t);case 7:if(!t.error_code){e.next=9;break}throw t;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),se(Object(m.b)(e.t0.error_code,v));case 14:ae(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),Pe=function(e){var t=e.blocked_list.ip,a=e.allowed_list.ip;q({blockList:t,allowList:a})},Ye=function(){var e=Y.blockList,t=Y.allowList;nt(),e.forEach((function(e){if(e.ip.includes("-")){var t=e.ip.split("-"),a=t[0],i=t[1];Z((function(e){return{from:[].concat(Object(n.a)(e.from),[a]),to:[].concat(Object(n.a)(e.to),[i])}}))}else Z((function(t){return{from:[].concat(Object(n.a)(t.from),[e.ip]),to:[].concat(Object(n.a)(t.to),[e.ip])}}))})),t.forEach((function(e){if(e.ip.includes("-")){var t=e.ip.split("-"),a=t[0],i=t[1];Z((function(e){return{from:[].concat(Object(n.a)(e.from),[a]),to:[].concat(Object(n.a)(e.to),[i])}}))}else Z((function(t){return{from:[].concat(Object(n.a)(t.from),[e.ip]),to:[].concat(Object(n.a)(t.to),[e.ip])}}))}))},qe=function(e){var t=Ze(e),a=t.isValidIp,n=t.isIpDuplicateInBlockList,l=t.isIpDuplicateInAllowList,s=t.isIpDuplicateInBlockListMessage,c=t.isIpDuplicateInAllowListMessage;Ee((function(e){return Object(i.a)(Object(i.a)({},e),{},{isValidIp:a,isIpDuplicateInBlockList:n,isIpDuplicateInAllowList:l,isIpDuplicateInBlockListMessage:s,isIpDuplicateInAllowListMessage:c})})),a||$e()},Qe=function(e){var t=Ze(e),a=t.isValidIp,n=t.isIpDuplicateInBlockList,l=t.isIpDuplicateInAllowList,s=t.isIpDuplicateInBlockListMessage,c=t.isIpDuplicateInAllowListMessage;Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{fromIp:Object(i.a)(Object(i.a)({},e.fromIp),{},{isValidFromIp:a,isFromIpDuplicateInBlockList:n,isFromIpDuplicateInAllowList:l,isFromIpDuplicateInBlockListMessage:s,isFromIpDuplicateInAllowListMessage:c})})})),a||et()},Ue=function(e){var t=Ze(e),a=t.isValidIp,n=t.isIpDuplicateInBlockList,l=t.isIpDuplicateInAllowList,s=t.isIpDuplicateInBlockListMessage,c=t.isIpDuplicateInAllowListMessage;Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{toIp:Object(i.a)(Object(i.a)({},e.toIp),{},{isValidToIp:a,isToIpDuplicateInBlockList:n,isToIpDuplicateInAllowList:l,isToIpDuplicateInBlockListMessage:s,isToIpDuplicateInAllowListMessage:c})})})),a||tt()},Xe=function(){var e=he.fromIp.fromIpAddress,t=he.toIp.toIpAddress,a=function(e,t){var a=D(e);return D(t)>a}(e,t),n=function(e,t,a){for(var i,n=a.from,l=a.to,s=D(e),c=D(t),o=0;o<n.length;o++){var r=D(n[o]),p=D(l[o]);if(s<=r&&c>=p){i=!0;break}i=!1}return i}(e,t,X),l=n&&v("rangeIpDuplicated");Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{isToIpGreaterThanFromIp:a,isRangeIpDuplicate:n,isRangeIpDuplicateMessage:l})}))},Ze=function(e){var t,a,i,n,l,s=Y.blockList,c=Y.allowList,o=(t=e,b.ipPattern.test(t));return o&&(a=L(e,s),i=L(e,c),n=a&&v("ipDuplicatedInBlockList"),l=i&&v("ipDuplicatedInAllowList")),{isValidIp:o,isIpDuplicateInBlockList:a,isIpDuplicateInAllowList:i,isIpDuplicateInBlockListMessage:n,isIpDuplicateInAllowListMessage:l}},$e=function(){Ee((function(e){return Object(i.a)(Object(i.a)({},e),{},{isValidIp:!1,isIpDuplicateInBlockList:!0,isIpDuplicateInAllowList:!0,isIpDuplicateInBlockListMessage:"",isIpDuplicateInAllowListMessage:""})}))},et=function(){Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{fromIp:Object(i.a)(Object(i.a)({},e.fromIp),{},{isValidFromIp:!1,isFromIpDuplicateInBlockList:!0,isFromIpDuplicateInAllowList:!0,isFromIpDuplicateInBlockListMessage:"",isFromIpDuplicateInAllowListMessage:""})})}))},tt=function(){Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{toIp:Object(i.a)(Object(i.a)({},e.toIp),{},{isValidToIp:!1,isToIpDuplicateInBlockList:!0,isToIpDuplicateInAllowList:!0,isToIpDuplicateInBlockListMessage:"",isToIpDuplicateInAllowListMessage:""})})}))},at=function(){Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{isToIpGreaterThanFromIp:!1,isRangeIpDuplicate:!0,isRangeIpDuplicateMessage:""})}))},it=function(){Ee((function(e){return Object(i.a)(Object(i.a)({},e),{},{ipAddress:""})})),Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{fromIp:Object(i.a)(Object(i.a)({},e.fromIp),{},{fromIpAddress:""}),toIp:Object(i.a)(Object(i.a)({},e.toIp),{},{toIpAddress:""})})}))},nt=function(){Z({from:[],to:[]})},lt=function(){var e=Object(c.a)(s.a.mark((function e(t,a){var i,n,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},n={},c="delete"===a?l.axiosDelete(I.d.fraudIp,i,t,n):l.axiosPut(I.d.fraudIp,t,i,n),e.prev=3,e.next=6,c;case 6:if(!(o=e.sent).error_code){e.next=9;break}throw o;case 9:e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(3),Se({title:Object(m.c)(e.t0.error_code,v),description:Object(m.b)(e.t0.error_code,v)}),We(!0),_e(!1),e.abrupt("return");case 17:ze(),Ke(),_e(!1),Ie(!1),ge(!1),Se({title:"",description:""});case 23:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t,a){return e.apply(this,arguments)}}(),st=function(){a.push({pathname:I.e.fraudGuard,state:{selectedTabIndex:1}})},ct=Y.blockList,ot=Y.allowList,rt=A?ot:ct,pt=p.a.createElement(w,{isAllowList:A,listEventHistory:G,isLoading:z}),ut=p.a.createElement(T,{list:rt,isLoading:te,errorMessage:le,openAddModal:function(){return Ie(!0)},openDeleteModal:function(e){Be(e),ge(!0)},allowedToEdit:x}),dt=p.a.createElement(V,{specificIpInput:Le,rangeIpInput:he,isAllowList:A,isModalOpen:me,closeAddModal:function(){return Ie(!1)},setActiveTab:pe,activeTab:re,handleChange:function(e){e.preventDefault();var t=e.target.name,a=e.target.value;switch(t){case"specificIp":Ee((function(e){return Object(i.a)(Object(i.a)({},e),{},{ipAddress:a})})),qe(a);break;case"fromIp":Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{fromIp:Object(i.a)(Object(i.a)({},e.fromIp),{},{fromIpAddress:a})})})),Qe(a);break;case"toIp":Ae((function(e){return Object(i.a)(Object(i.a)({},e),{},{toIp:Object(i.a)(Object(i.a)({},e.toIp),{},{toIpAddress:a})})})),Ue(a);break;default:return}},addData:function(e){e.preventDefault();var t=Le.ipAddress,a=he.fromIp.fromIpAddress,i=he.toIp.toIpAddress;_e(!0),lt({ip:0===re?t:a+"-"+i,is_block_list:!A},"add")},isAddingData:ye}),mt=p.a.createElement(C,{toBeDeletedIp:xe,isAllowList:A,isModalOpen:je,closeDeleteModal:function(){return ge(!1)},deleteData:function(){var e;_e(!0),rt.forEach((function(t){t.ip===xe&&(e=t.id)})),lt({ip:xe,is_block_list:!A,id:e},"delete")},isDeletingData:ye}),It=p.a.createElement(E.j,{type:"danger",title:Ce.title,subtitle:Ce.description,showModal:He,handleClose:function(){return We(!1)}});return p.a.createElement(p.a.Fragment,null,p.a.createElement(E.o,{goBack:st,title:v("fraudList")}),pt,ut,dt,mt,It)}))},1934:function(e,t,a){}}]);