(this["webpackJsonpxendit-dashboard-ui"]=this["webpackJsonpxendit-dashboard-ui"]||[]).push([[108],{1524:function(e,t,a){"use strict";a.r(t);var n=a(3),o=a(9),r=a.n(o),c=a(19),i=a(12),l=a(0),s=a.n(l),u=a(380),d=a(27),m=a(468),p=a(167),b=a(189),f={country:"",countryCode:"",isCountryDuplicateInBlockList:!0,isCountryDuplicateInAllowList:!0,isCountryDuplicateInBlockListMessage:"",isCountryDuplicateInAllowListMessage:""},y=function(e,t){return t.some((function(t){return e===t.country_code}))},h=a(80),w=a(1565),E=Object(u.a)("fraudGuard")((function(e){var t,a=e.isAllowList,n=e.listEventHistory,o=e.isLoading,r=e.t,c=n.email,i=n.timestamp,l=""===c&&""===i,u=r(a?"countryAllowList":"countryBlockList"),d=s.a.createElement("p",{className:"text-md font-weight-bold mb-0 mr-3"},u);if(o)t=r("fetchingEventHistory");else{var m=s.a.createElement(w.a,{i18nKey:"fraudListEventHistory"},"This list was last modified by"," ",s.a.createElement("span",{className:"font-weight-bold"},{email:c})," on"," ",s.a.createElement("span",{className:"font-weight-bold"},{timestamp:i}),".");t=l?r("fraudListEventHistoryEmpty"):m}var p=r(a?"countryAllowListDescription":"countryBlockListDescription"),b=r(a?"countryAllowListExample":"countryBlockListExample"),f=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",{className:"color-charcoal"},t),s.a.createElement("p",{className:"mt-2 mb-0"},p),s.a.createElement("p",null,b));return s.a.createElement(h.z,{title:d,children:f})})),g=a(37),O=a(26),j=a(20),C=a.n(j),v=a(290),L=a.n(v),x=Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.list,a=e.isLoading,n=e.errorMessage,o=e.openAddModal,r=e.openDeleteModal,c=e.allowedToEdit,i=e.t,l=[{dataField:"countryValue",text:i("country"),headerStyle:{width:"30%"}},{dataField:"formattedDate",text:i("dateAdded"),headerStyle:{width:"20%"}},{dataField:"deleteButton",text:"",headerStyle:{width:"50%"}}],u=t.map((function(e){var t=e.country,a=e.country_code,n=e.updated,o=a&&"Pending"!==a&&s.a.createElement("img",{className:"card-country-icon mr-3",src:"https://country-flags-images.s3.amazonaws.com/flags/".concat(a.toLowerCase(),".svg"),alt:a}),i=t&&t.toLowerCase();return{countryValue:t&&"Pending"!==t?s.a.createElement("div",{className:"d-flex align-items-center color-inherit text-capitalize"},o,i):"-",formattedDate:Object(b.h)(n),deleteButton:c?s.a.createElement(h.h,{withTooltip:!1,icon:s.a.createElement(g.a,{icon:O.K}),onClick:function(){return r(t,a)},customCss:"btn-no-bg table-icon-button"}):null}})),m=s.a.createElement(C.a,{iconLeft:s.a.createElement(g.a,{icon:O.C}),size:"sm",onClick:o},i("commonWords:add")),p=c&&s.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},s.a.createElement("p",{className:"color-charcoal"},i("addListInstruction")),m);return s.a.createElement(h.z,{isLoading:a,loadingText:i("loadingYourList"),isError:!Object(d.isEmpty)(n),errorText:n,isEmpty:Object(d.isEmpty)(t),emptySubtitle:i("emptyFraudListCaption"),title:p},s.a.createElement(L.a,{noBorder:!0,tableHeaderColumns:l,tableContentRows:u,customCssRow:"fraud-list-table-row"}))})),k=a(49),D=a.n(k),_=a(252),A=a.n(_),M=Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.countryList,a=e.countryInput,n=e.isAllowList,o=e.isModalOpen,r=e.closeAddModal,c=e.handleChange,i=e.addData,l=e.isAddingData,u=e.t,d=a.country,m=a.countryCode,p=a.isCountryDuplicateInBlockList,b=a.isCountryDuplicateInAllowList,f=a.isCountryDuplicateInBlockListMessage,y=a.isCountryDuplicateInAllowListMessage,w=u(n?"addCountryAllow":"addCountryBlock"),E=!p&&!b,j=E?"valid":"",v=!d&&!m||!E,L=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",{className:"d-flex align-items-center input-validity mt-2 mb-2 ".concat(j)},s.a.createElement(g.a,{icon:O.h}),u("notDuplicated")),s.a.createElement("p",{className:"color-danger"},f,y)),x=s.a.createElement("div",{className:"d-flex flex-column position-relative mb-4"},s.a.createElement(A.a,{onChange:function(e){return c(e.label,e.value)},options:t,placeholder:u("selectCountry"),defaultValue:m}),L),k=s.a.createElement(h.gb,{onSubmit:function(e){return i(e)}},x),_=s.a.createElement("div",{className:"text-left mt-3"},k),M=s.a.createElement(C.a,{size:"md",type:"submit",isDisabled:v,isLoading:l,onClick:i},u("commonWords:add"));return s.a.createElement(D.a,{showModal:o,handleClose:r,title:w,children:_,footer:M,size:"sm"})})),I=Object(u.a)(["fraudGuard","commonWords"])((function(e){var t=e.toBeDeletedCountry,a=e.isAllowList,n=e.isModalOpen,o=e.closeDeleteModal,r=e.deleteData,c=e.isDeletingData,i=e.t,l=t.country,u=t.countryCode,d=i(a?"deleteCountryAllow":"deleteCountryBlock"),m=i(a?"deleteCountryAllowInstruction":"deleteCountryBlockInstruction"),p=s.a.createElement("img",{className:"card-country-icon mr-3",src:"https://country-flags-images.s3.amazonaws.com/flags/".concat(u.toLowerCase(),".svg"),alt:u}),b=s.a.createElement("div",{className:"d-flex align-items-center"},p,s.a.createElement("span",{className:"font-weight-bolder"},l)),f=s.a.createElement("div",{className:"confirmation-modal-additional-content text-left mt-3"},s.a.createElement("div",{className:"d-flex align-items-center text-left mb-4"},s.a.createElement("span",{className:"color-charcoal mr-2"},i("country"),": "),b),s.a.createElement("p",{className:"text-left color-charcoal"},m));return s.a.createElement(h.j,{type:"danger",title:d,showModal:n,handleClose:o,handleConfirm:r,withCancel:!0,isButtonLoading:c,buttonText:i("commonWords:delete"),buttonType:"destructive",buttonCustomCss:"min-width-120",additionalContent:f})}));t.default=Object(u.a)(["fraudGuard","creditCardErrorMessages","errorMessages"])((function(e){var t=e.location,a=e.history,o=e.apiCall,u=e.user,w=e.environment,g=e.t,O=t.pathname.split("/"),j="country_allow_list"===O[O.length-1],C=u.can_administer,v=u.can_manage_tech_settings,L=C&&v,k=Object(l.useState)(!1),D=Object(i.a)(k,2),_=D[0],A=D[1],B=Object(l.useState)({email:"",timestamp:""}),N=Object(i.a)(B,2),S=N[0],G=N[1],T=Object(l.useState)(!1),z=Object(i.a)(T,2),F=z[0],H=z[1],W=Object(l.useState)({blockList:[],allowList:[]}),P=Object(i.a)(W,2),R=P[0],V=P[1],J=Object(l.useState)(!1),K=Object(i.a)(J,2),Y=K[0],q=K[1],Q=Object(l.useState)(""),U=Object(i.a)(Q,2),X=U[0],Z=U[1],$=Object(l.useState)(!1),ee=Object(i.a)($,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),oe=Object(i.a)(ne,2),re=oe[0],ce=oe[1],ie=Object(l.useState)(f),le=Object(i.a)(ie,2),se=le[0],ue=le[1],de=Object(l.useState)({country:"",countryCode:""}),me=Object(i.a)(de,2),pe=me[0],be=me[1],fe=Object(l.useState)(!1),ye=Object(i.a)(fe,2),he=ye[0],we=ye[1],Ee=Object(l.useState)({title:"",description:""}),ge=Object(i.a)(Ee,2),Oe=ge[0],je=ge[1],Ce=Object(l.useState)(""),ve=Object(i.a)(Ce,2),Le=ve[0],xe=ve[1],ke=Object(l.useState)([]),De=Object(i.a)(ke,2),_e=De[0],Ae=De[1];Object(l.useEffect)((function(){A(!0),Me(),Be(),Se()}),[]),Object(l.useEffect)((function(){ze(),Fe()}),[te,he]),Object(l.useEffect)((function(){je({title:"",description:""})}),[te,re]),Object(l.useEffect)((function(){_&&We()}),[w]);var Me=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),e.prev=1,e.next=4,o.axiosGet(p.d.ccSettingsLogger);case 4:if(!(t=e.sent).error_code){e.next=7;break}throw t;case 7:Ie(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Z(Object(m.b)(e.t0.error_code,g));case 13:H(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),Ie=function(e){var t=e.bin_country_blocked_list,a=e.bin_country_allowed_list,n=j?a:t;G({email:Object(d.isEmpty)(n)?"":n.last_update_history_item.email,timestamp:Object(d.isEmpty)(n)?"":Object(b.h)(n.last_update_history_item.timestamp)})},Be=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.prev=1,e.next=4,o.axiosGet(p.d.customFraudRules);case 4:if(!(t=e.sent).error_code){e.next=7;break}throw t;case 7:Ne(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Z(Object(m.b)(e.t0.error_code,g));case 13:q(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),Ne=function(e){var t=e.blocked_list.bin_country,a=e.allowed_list.bin_country;V({blockList:t,allowList:a})},Se=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.axiosGet(p.d.countryLookup);case 3:if(!(t=e.sent).error_code){e.next=6;break}throw t;case 6:Ge(t.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Z(Object(m.b)(e.t0.error_code,g));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ge=function(e){var t=[];e.forEach((function(e){var a=e.country,n=e.country_code;if(a){var o=a.toLowerCase(),r=Object(d.startCase)(o);t.push({label:r,value:n})}})),Ae(t)},Te=function(e){var t=R.blockList,a=R.allowList,o=y(e,t),r=y(e,a),c=o&&g("countryDuplicatedInBlockList"),i=r&&g("countryDuplicatedInAllowList");ue((function(e){return Object(n.a)(Object(n.a)({},e),{},{isCountryDuplicateInBlockList:o,isCountryDuplicateInAllowList:r,isCountryDuplicateInBlockListMessage:c,isCountryDuplicateInAllowListMessage:i})}))},ze=function(){ue((function(e){return Object(n.a)(Object(n.a)({},e),{},{isCountryDuplicateInBlockList:!0,isCountryDuplicateInAllowList:!0,isCountryDuplicateInBlockListMessage:"",isCountryDuplicateInAllowListMessage:""})}))},Fe=function(){ue((function(e){return Object(n.a)(Object(n.a)({},e),{},{country:"",countryCode:""})}))},He=function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c,i,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},c={},i="delete"===a?o.axiosDelete(p.d.fraudCountry,n,t,c):o.axiosPut(p.d.fraudCountry,t,n,c),e.prev=3,e.next=6,i;case 6:if(!(l=e.sent).error_code){e.next=9;break}throw l;case 9:e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(3),je({title:Object(m.c)(e.t0.error_code,g),description:Object(m.b)(e.t0.error_code,g)}),xe(!0),we(!1),e.abrupt("return");case 17:Me(),Be(),we(!1),ae(!1),ce(!1),je({title:"",description:""});case 23:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t,a){return e.apply(this,arguments)}}(),We=function(){a.push({pathname:p.e.fraudGuard,state:{selectedTabIndex:1}})},Pe=R.blockList,Re=R.allowList,Ve=j?Re:Pe,Je=s.a.createElement(E,{isAllowList:j,listEventHistory:S,isLoading:F}),Ke=s.a.createElement(x,{list:Ve,isLoading:Y,errorMessage:X,openAddModal:function(){return ae(!0)},openDeleteModal:function(e,t){be({country:e,countryCode:t}),ce(!0)},allowedToEdit:L}),Ye=s.a.createElement(M,{countryList:_e,countryInput:se,isAllowList:j,isModalOpen:te,closeAddModal:function(){return ae(!1)},handleChange:function(e,t){ue((function(a){return Object(n.a)(Object(n.a)({},a),{},{country:e,countryCode:t})})),Te(t)},addData:function(e){e.preventDefault();var t=se.country,a=se.countryCode;we(!0),He({country:t,country_code:a,is_block_list:!j,id:" "},"add")},isAddingData:he}),qe=s.a.createElement(I,{toBeDeletedCountry:pe,isAllowList:j,isModalOpen:re,closeDeleteModal:function(){return ce(!1)},deleteData:function(){var e;we(!0),Ve.forEach((function(t){t.country===pe.country&&(e=t.id)})),He({is_block_list:!j,id:e},"delete")},isDeletingData:he}),Qe=s.a.createElement(h.j,{type:"danger",title:Oe.title,subtitle:Oe.description,showModal:Le,handleClose:function(){return xe(!1)}});return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.o,{goBack:We,title:g("fraudList")}),Je,Ke,Ye,qe,Qe)}))}}]);