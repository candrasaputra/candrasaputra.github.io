(this["webpackJsonpxendit-dashboard-ui"]=this["webpackJsonpxendit-dashboard-ui"]||[]).push([[77],{1536:function(t,e,n){"use strict";n.r(e);var a=n(24),r=n(9),o=n.n(r),c=n(19),s=n(12),i=n(0),u=n.n(i),l=n(31),d=n.n(l),p=n(1598),m=n.n(p),f=n(380),b=n(67),O=n(27),E=n(37),_=n(26),y=n(1583),R=n.n(y),S=n(20),T=n.n(S),j=n(80),C=n(50),x=n(48),h=n(189),D=n(284),v=n(205),A=n(1573),g="/images/icons/idr.png",L="/images/icons/money_in.png",N="/images/icons/money_out.png",w="/images/icons/transactions.svg",M="/api/escrow-transaction-stats",I="/api/escrow-transaction-history",F="/api/escrow_transaction_report_requests",W=function(t){return"/escrow-account/".concat(t)},k=["LOAN_DISBURSEMENT","LOAN_DISBURSEMENT_REFUND","LOAN_DISBURSEMENT_ADMIN_FEE","ESCROW_EXTERNAL_VIRTUAL_ACCOUNT_PAYMENT","ESCROW_WITHDRAWAL","ESCROW_WITHDRAWAL_REFUND","REPAYMENT","REPAYMENT_ADMIN_FEE","ESCROW_TO_RDL_REPAYMENT","RDL_TO_ESCROW_DEPOSIT","ESCROW_TO_RDL_REFUND","INTERNAL_TRANSFER"],P=function(t){var e=t.totalBalance,n=t.totalMoneyIn,a=t.totalMoneyOut,r=t.totalTransactions,o=t.t,c=t.isLoading,s=[{text:o("totalBalance"),icon:g,amount:e&&Object(A.d)(e),currency:"IDR"},{text:o("totalMoneyIn"),icon:L,amount:n&&Object(A.d)(n),currency:"IDR"},{text:o("totalMoneyOut"),icon:N,amount:a&&Object(A.d)(a),currency:"IDR"},{text:o("totalTransactions"),icon:w,amount:r}];return u.a.createElement(D.a,null,s.map((function(t,e){return u.a.createElement(v.a,{md:6,lg:3,key:"col-".concat(e)},u.a.createElement(j.Z,{key:"stats-".concat(e),text:t.text,icon:t.icon,amount:t.amount,currency:t.currency,isLoading:c}))})))},U=n(3),B=n(1575),H=n.n(B),Y=n(288),q=n.n(Y),V=function(t){var e=q()(null===t||void 0===t?void 0:t.toLowerCase());switch(t){case"COMPLETED":case"SETTLED":return u.a.createElement(H.a,{variant:"success",text:e});default:return u.a.createElement(H.a,{text:e})}},G=function(t){return t.map((function(t){return Object(U.a)(Object(U.a)({},t),{},{created:d()(t.timestamp).format(x.a.DATE_WITHOUT_SECONDS),amount:t.amount&&Object(A.d)(t.amount)})}))},J=function(t){return[{dataField:"status",text:t("status"),formatter:V,headerStyle:{width:"10%"}},{dataField:"created",text:t("createdDate")},{dataField:"id",text:t("id")},{dataField:"product_type",text:t("type")},{dataField:"external_id",text:t("reference")},{dataField:"amount",text:t("amount")},{dataField:"customer_id",text:t("customerId")}]},Q=function(t){return{width:"5%",items:[{field:"external_id",text:t("copyReference"),textPressed:t("commonWords:valueCopied"),action:"copy"},{field:"customer_id",text:t("copyCustomerId"),textPressed:t("commonWords:valueCopied"),action:"copy"},{field:"id",text:t("copyId"),textPressed:t("commonWords:valueCopied"),action:"copy"}]}},X=[{children:[{type:"LOAN_DISBURSEMENT",label:"Loan Disbursement"},{type:"LOAN_DISBURSEMENT_REFUND",label:"Loan Disbursement Refund"},{type:"LOAN_DISBURSEMENT_ADMIN_FEE",label:"Loan Disbursement Admin Fee"},{type:"ESCROW_EXTERNAL_VIRTUAL_ACCOUNT_PAYMENT",label:"VA Payment"},{type:"ESCROW_WITHDRAWAL",label:"Withdrawal"},{type:"ESCROW_WITHDRAWAL_REFUND",label:"Withdrawal Refund"},{type:"REPAYMENT",label:"Repayment"},{type:"REPAYMENT_ADMIN_FEE",label:"Repayment Admin Fee"},{type:"ESCROW_TO_RDL_REPAYMENT",label:"Escrow to RDL Repayment"},{type:"RDL_TO_ESCROW_DEPOSIT",label:"RDL to Escrow Deposit"},{type:"ESCROW_TO_RDL_REFUND",label:"Escrow to RDL Refund"},{type:"INTERNAL_TRANSFER",label:"Internal Transfer"}]}],Z=n(473);e.default=Object(b.o)(Object(f.a)(["escrow","commonComponents"])((function(t){var e=t.t,n=t.dateFormat,r=t.apiCall,l=r.axiosGet,p=r.axiosPost,f=t.business,b=t.user.email,y=t.history,S=t.environment,D=Object(i.useState)({totalBalance:0,totalMoneyIn:0,totalMoneyOut:0,totalTransactions:0}),v=Object(s.a)(D,2),A=v[0],g=v[1],L=Object(i.useState)(!1),N=Object(s.a)(L,2),w=N[0],U=N[1],B=Object(i.useState)(""),H=Object(s.a)(B,2),Y=H[0],q=H[1],V=Object(i.useState)([]),z=Object(s.a)(V,2),$=z[0],K=z[1],tt=Object(i.useState)(!1),et=Object(s.a)(tt,2),nt=et[0],at=et[1],rt=Object(i.useState)(!1),ot=Object(s.a)(rt,2),ct=ot[0],st=ot[1],it=Object(i.useState)(!1),ut=Object(s.a)(it,2),lt=ut[0],dt=ut[1],pt=Object(i.useState)(void 0),mt=Object(s.a)(pt,2),ft=mt[0],bt=mt[1],Ot=Object(i.useState)(!1),Et=Object(s.a)(Ot,2),_t=Et[0],yt=Et[1],Rt=Object(i.useState)(k),St=Object(s.a)(Rt,2),Tt=St[0],jt=St[1],Ct=Object(i.useState)(new Date(x.c.LAST_1_MONTH)),xt=Object(s.a)(Ct,2),ht=xt[0],Dt=xt[1],vt=Object(i.useState)(new Date(x.c.TODAY)),At=Object(s.a)(vt,2),gt=At[0],Lt=At[1],Nt=Object(i.useState)(""),wt=Object(s.a)(Nt,2),Mt=wt[0],It=wt[1],Ft=Object(i.useState)(null),Wt=Object(s.a)(Ft,2),kt=Wt[0],Pt=Wt[1],Ut=Object(i.useState)(!1),Bt=Object(s.a)(Ut,2),Ht=Bt[0],Yt=Bt[1],qt=Object(i.useState)({title:"",subtitle:"",type:"",showModal:!1}),Vt=Object(s.a)(qt,2),Gt=Vt[0],Jt=Vt[1],Qt=function(){var t=Object(c.a)(o.a.mark((function t(){var e,n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return st(!0),e=y.location.state&&y.location.state.isFromDetailsPage,t.next=4,m.a.getItem("LAST_ESCROW_TRANSACTIONS");case 4:if(n=t.sent,!e||Object(O.isNull)(n)){t.next=21;break}return a=JSON.parse(n),bt(a.lastSequence),K(a.escrowData),K(a.escrowData),at(a.hasNext),Dt(a.dateStart),Lt(a.dateEnd),jt(a.types),It(a.searchQuery),st(!1),t.next=18,m.a.removeItem("LAST_ESCROW_TRANSACTIONS");case 18:y.replace({pathname:y.location.pathname,state:{}}),t.next=23;break;case 21:Xt(),Zt(!1);case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(i.useEffect)((function(){Qt()}),[S]),Object(i.useEffect)((function(){_t&&(Xt(),Zt(!1),yt(!1))}),[Tt,ht,gt]),Object(i.useEffect)((function(){clearTimeout(kt),Pt(setTimeout((function(){_t&&(!Mt||Mt.length>2)&&(Xt(),Zt(!1),yt(!1))}),500))}),[Mt]);var Xt=function(){var t=Object(c.a)(o.a.mark((function t(){var n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return U(!0),n={account_type:"CASH",product_types:Tt,from:Object(h.c)(ht,"start"),to:Object(h.c)(gt,"end"),status:[]},Mt&&(n.search_query=Mt.trim()),t.next=5,l(M,n);case 5:if(a=t.sent,U(!1),!a.error_code){t.next=12;break}if(a.error_code!==Z.a.REQUEST_ABORTED){t.next=10;break}return t.abrupt("return");case 10:return q(Object(C.f)(a.error_code,e)),t.abrupt("return");case 12:g({totalBalance:a.total_balance,totalMoneyIn:a.total_money_in,totalMoneyOut:a.total_money_out,totalTransactions:a.total_transactions});case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Zt=function(){var t=Object(c.a)(o.a.mark((function t(n){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n||(st(!0),K([])),r={account_type:"CASH",product_types:Tt,from:Object(h.c)(ht,"start"),to:Object(h.c)(gt,"end"),status:[],last_sequence:n?ft:void 0},Mt&&(r.search_query=Mt.trim()),t.next=5,l(I,r);case 5:if(c=t.sent,st(!1),!c.error_code){t.next=12;break}if(c.error_code!==Z.a.REQUEST_ABORTED){t.next=10;break}return t.abrupt("return");case 10:return q(Object(C.f)(c.error_code,e)),t.abrupt("return");case 12:c.length>9?(at(!0),bt(c[c.length-1].sequence)):(at(!1),bt(void 0)),n?(K([].concat(Object(a.a)($),Object(a.a)(c))),dt(!1)):K(c);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),zt=function(){var t=Object(c.a)(o.a.mark((function t(){var n,a,r,c,i,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Yt(!0),n={account_type:"CASH",product_types:Tt,from:Object(h.c)(ht,"start"),to:Object(h.c)(gt,"end"),user_offset:d()().utcOffset(),export_type:"CSV"},t.next=4,p(F,{},n);case 4:if(a=t.sent,Yt(!1),!a.error_code){t.next=15;break}t.t0=a.error_code,t.next="EXPORT_CSV_COUNT_LIMIT_ERROR"===t.t0?10:13;break;case 10:return r=a.message.split(" "),c=Object(s.a)(r,2),i=c[0],u=c[1],$t(e("commonComponents:exportFailed"),e("exportFailedInfo",{exportCsvLimit:i,currentExportCsvCount:u}),"danger"),t.abrupt("return");case 13:return $t(e("commonComponents:exportFailed"),null,"danger"),t.abrupt("return");case 15:$t(e("commonComponents:exportStarted"),e("commonComponents:exportSuccessInfo",{email:b}),"success"),window.dataLayer.push({businessId:f.id,event:"export-escrow-transactions-report",label:"Export CSV - Escrow Transactions"});case 17:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),$t=function(t,e,n,a){Jt({title:t,subtitle:e,type:n,showModal:!0,additionalContent:a})},Kt={isClickable:!0,tableHeaderColumns:J(e),tableContentRows:G($),onClickLoadMore:function(){dt(!0),Zt(!0)},withLoadMore:nt,loadMoreText:e("commonComponents:tableMore"),isLoadingMore:lt,isLoading:ct,isError:!Object(O.isEmpty)(Y),isEmpty:Object(O.isEmpty)($),loadingText:e("loadingEscrow"),errorContent:u.a.createElement(j.t,{text:Y}),emptyContent:u.a.createElement(j.r,{caption:e("emptyEscrow"),subtitle:e("emptyEscrow")}),actionButtonConfig:Q(e),onDetailsClicked:function(t){return function(t){y.replace({pathname:y.location.pathname,state:{isFromDetailsPage:!0}}),y.push({pathname:W(t.id),search:"?product_type=".concat(t.product_type)})}(t)}},te=function(t,e,n,a){var r=e.length;return[u.a.createElement(j.q,{displayText:"".concat(t("transactionType")," (").concat(r,")"),children:[u.a.createElement(j.w,{selectedFilters:e,filterGroups:X,withCheckAll:!0,onChecked:n,onCheckAll:a})]})]}(e,Tt,(function(t){var e=Object(a.a)(Tt);Tt.includes(t)?e=e.filter((function(e){return e!==t})):e.push(t),jt(e),yt(!0)}),(function(){var t=Object(O.isEmpty)(Tt)?k:[];jt(t),yt(!0)})),ee={start:ht,end:gt,inputFormat:n.date_time_picker,outputFormat:x.a.GMT_MS_Z,onChange:function(t,e){switch(yt(!0),t){case"start":Dt(new Date(e));break;case"end":Lt(new Date(e))}},customCss:"filter-item"},ne={value:Mt,onChange:function(t){t.preventDefault(),It(t.target.value),yt(!0)},tooltip:e("searchTooltip"),placeholder:e("search"),position:"inline",customCss:"filter-item"},ae=[u.a.createElement(T.a,{iconLeft:u.a.createElement(E.a,{icon:_.p}),onClick:zt,isLoading:Ht,size:"sm"},"CSV")];return u.a.createElement(u.a.Fragment,null,u.a.createElement(P,{totalBalance:A.totalBalance,totalMoneyIn:A.totalMoneyIn,totalMoneyOut:A.totalMoneyOut,totalTransactions:A.totalTransactions,isLoading:w,t:e}),u.a.createElement(R.a,{stickyHeader:!0,filters:te,rightButtons:ae,dateFilterConfig:ee,tableConfig:Kt,searchBarConfig:ne}),u.a.createElement(j.j,Object.assign({},Gt,{handleClose:function(){Jt({title:"",subtitle:"",type:"",showModal:!1})}})))})))},1573:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return i}));var a=function(t,e){return"IDR"!==e&&e?t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"):t.toFixed(2).replace(".",",").replace(/\B(?=(\d{3})+(?!\d))/g,".")},r=function(t){return t.toLocaleString("en-US").replace(/,/g,".")},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.toLocaleString("en-US",{minimumFractionDigits:e?2:0})},c=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=o(t,a),c="IDR"===e?r.replace(/,/g,"."):r,s=n?"".concat(e," "):"",i="".concat(s).concat(c);return i},s=function(t,e,n){var a=e?c(t,e):o(t),r=a.split("-").join(""),s="".concat((null!=n?n:t>0)?"+ ":"- "," ").concat(r);return 0===t&&(s=a),s},i=function(t){return"".concat((100*t).toFixed(2),"%")}},1575:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(n(0)),r=s(n(2)),o=s(n(6)),c=s(n(1576));function s(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(1577);var u=function(t){var e,n=t.text,r=t.iconLeft,s=t.customCss,u=t.variant,l=(0,o.default)((i(e={"status-pill":!0},"status-pill-".concat(u),u),i(e,s,s),e));return a.default.createElement(c.default,{text:n,iconLeft:r,customCss:l})};u.propTypes={text:r.default.string,iconLeft:r.default.any,variant:r.default.oneOf(["success","danger","warning","first-level","second-level"]),customCss:r.default.string};var l=u;e.default=l},1576:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),t.exports=n(467)},1577:function(t,e,n){}}]);